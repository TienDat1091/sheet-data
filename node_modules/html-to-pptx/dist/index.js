"use strict";function t(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}Object.defineProperty(exports,"__esModule",{value:!0});var e=t(require("pptxgenjs"));function o(t){const o=new e.default,s=Array.from(document.querySelectorAll(t)).filter((t=>t.offsetWidth>0&&t.offsetHeight>0&&"hidden"!==getComputedStyle(t).visibility));return Array.from(s).forEach((t=>{var e,s,c;const d=o.addSlide(),{styles:u,attributes:f}=a(t),g=u["background-image"]&&(null===(s=null===(e=u["background-image"])||void 0===e?void 0:e.match(/url\(["']?([^"']*)["']?\)/))||void 0===s?void 0:s.length)?null===(c=u["background-image"])||void 0===c?void 0:c.match(/url\(["']?([^"']*)["']?\)/)[1]:null;d.background={color:i(u["background-color"]),path:g},t.childNodes.forEach((t=>{if(t.nodeType===Node.ELEMENT_NODE){const e=t.innerHTML,{styles:o,attributes:s}=a(t),{width:c,height:u,top:f,left:g,color:p}=o,h=o["align-items"],m=o["justify-content"],y=.3*parseInt(o["font-size"],10),b=o["font-weight"],v=o["border-color"];if("text"===s.type)if(e.startsWith("<ul")||e.startsWith("<li")){let o;o=t.querySelectorAll("li");let s=0,c=!0,u=0;o.forEach((t=>{var o;const{styles:p}=a(t),{width:h,height:m,top:y,left:b,color:v}=p,x=p["padding-left"],w=p["padding-right"],E=p["padding-top"],T=p["padding-bottom"],S=p["align-items"],j=p["justify-content"],N=.3*parseInt(p["font-size"],10),A=p["font-family"],k=p["font-weight"];p["border-color"],t.getBoundingClientRect();let z=!1;("bold"===k||k>400)&&(z=!0,c||(s+=u),c&&(c=!1)),d.addText(t.textContent.trim(),{w:r(h),h:r(m),x:r(g),y:r(f)+s,align:l(j),valign:n(S),fontSize:N,color:i(v),bold:z,bullet:e.startsWith("<li"),fontFace:null===(o=A.split(",")[0])||void 0===o?void 0:o.trim(),margin:[r(E),r(w),r(T),r(x)]}),s+=r(m),u=r(T)}))}else d.addText(e,{w:r(c),h:r(u),x:r(g),y:r(f),align:l(m),valign:n(h),fontSize:y,color:i(p),bold:"bold"===b||b>400});else if("image"===s.type)d.addImage({path:s.src,x:r(g),y:r(f),w:r(c),h:r(u)});else if("table"===s.type)try{const e=[],o=t.getElementsByTagName("tr");for(let t of o){const o=[],r=t.getElementsByTagName("td");for(let t of r)o.push(t.innerText);e.push(o)}d.addTable(e,{w:r(c),h:r(u),x:r(g),y:r(f),align:l(m),valign:n(h),fontSize:y,color:i(p),bold:"bold"===b||b>400,border:{color:i(v)}})}catch(t){console.error("Error parsing table data:",t)}}}))})),o}function r(t){return parseInt(t,10)/192}function n(t){switch(t){case"flex-start":case"top":return"top";case"center":case"stretch":default:return"middle";case"flex-end":case"bottom":return"bottom"}}function l(t){switch(t){case"flex-start":case"left":default:return"left";case"center":return"center";case"flex-end":case"right":return"right";case"space-between":case"space-around":case"space-evenly":return"justify"}}function i(t){var e;const o=null===(e=t.match(/\d+/g))||void 0===e?void 0:e.map((t=>{const e=parseInt(t).toString(16);return 1===e.length?"0"+e:e}));return`#${null==o?void 0:o.join("")}`}function a(t){const e={};Array.from(t.attributes).forEach((t=>e[t.name]=t.value));const o=window.getComputedStyle(t),r={};return Array.from(o).forEach((t=>r[t]=o.getPropertyValue(t))),{styles:r,attributes:e}}exports.downloadHtmlToPpt=function(t="page",e="hope"){return o(t).writeFile({fileName:e+".pptx"})},exports.exportHtmlToPpt=function(t="page",e){var r;return null===(r=o(t))||void 0===r?void 0:r.write({outputType:e})};
